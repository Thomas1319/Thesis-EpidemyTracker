@model dynamic
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_LayoutLoggedin.cshtml";
}
    <div>
        <h4>Send a message</h4>
        <form asp-action="SendMessage" method="post">
            <input type="hidden" name="doctorId" value="@Model.Doctor.Id" />
            <input type="hidden" name="type" value="internal" />
            <input type="hidden" name="name" value="@Model.Doctor.firstName @Model.Doctor.lastName" />
            <input type="hidden" name="email" value="@Model.Doctor.Email" />
            <input type="hidden" name="date" value="@DateTime.UtcNow" />
            <div class="form-group">
                <input type="text" class="form-control" name="subject" placeholder="Subject" required />
            </div>
            <div class="form-group">
                <textarea class="form-control" name="message" placeholder="Write your message here..." required></textarea>
            </div>
            <div class="form-group">
                <button class="btn btn-info" type="submit" >Send</button>
            </div>

        </form>
        @if (Model.Messages.Count != 0)
        {
            <hr />

            <h4>Previous messages</h4>
            @foreach (var m in Model.Messages)
            {
                <div class="card">
                    <div class="card-header">
                        <div class="card-group">
                            <p class="card-title">@m.subject</p>
                            <p class="card-text">@m.timestamp</p>
                            @if (m.answer == null)
                            {
                                <i class="text-danger material-icons">cancel</i>
                            }
                            else
                            {
                                <i class="text-success material-icons">check_circle</i>
                            }
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="card-group">
                            <p class="card-title">Your message:</p>
                            <p class="card-text">@m.messageContent</p>
                        </div>
                        @if (m.answer != null)
                        {
                            <div class="card-group">
                                <p class="card-title">Answer:</p>
                                <p class="card-text">@m.answer</p>
                            </div>
                        }
                    </div>
                </div>
            }
        }

    </div>